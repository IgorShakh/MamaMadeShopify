/*! Mamamade v1.0.0 | (c) 2021 Tom Greenhill | MIT License | https://github.com/Charle-Team/mamamade */
!function(){"use strict";function e(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function t(t){e(1,arguments);var n=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===n?new Date(t.getTime()):"number"==typeof t||"[object Number]"===n?new Date(t):("string"!=typeof t&&"[object String]"!==n||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function n(n,r){e(2,arguments);var a=t(n),o=t(r),i=a.getTime()-o.getTime();return i<0?-1:i>0?1:i}function r(n,r){e(2,arguments);var a=t(n),o=t(r),i=a.getFullYear()-o.getFullYear(),c=a.getMonth()-o.getMonth();return 12*i+c}var a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),o=new Uint8Array(16);function i(){if(!a)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(o)}var c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function s(e){return"string"==typeof e&&c.test(e)}for(var u=[],l=0;l<256;++l)u.push((l+256).toString(16).substr(1));function d(e,t,n){var r=(e=e||{}).random||(e.rng||i)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n}(r)}var p={PROGRAMME_ID:0,TIME_ANIMATION:500,activeStage:"info"},m='[name="programme[charge_interval_frequency]"]',f="[data-restart]",g="[data-load]",h=function(){return $("#shopify-section-header")},v=function(){return $(".ProgrammeScheme")},y=function(){return $(".GroupCta .Button")},b=function(){return $('[name="programme[birthday]"]')},_=function(){return $('[name="programme[name]"]')},x=function(){return $('[name="programme[email]"]')},C=function(){return $('[name="programme[food]"]:checked')},w=function(){return $('[name="programme[milestone]"]:checked')},I=function(){return $(m)},T=function(){return $("".concat(m,":checked"))},k=function(){return $('[name="programme[charge_interval_unit_type]"]')},S=function(){return $("input[name^=programme][required]")},A=function(){return $(".Stages__Stage.is-active")},q=function(e){return $(".ProgrammeStage--".concat(e))},P=function(){return $(".ProgrammeStage:visible")},M=function(){return $(".StagesBanner")},B=function(){return $(".Stages__Stage")},E=function(e){return $("[data-programme-stage-0".concat(e,"]"))},O=function(){return $('[name="programme[products]"]')},j=function(){return $('[name="programme[upsells]"]')},R=function(){return $('[data-stage="confirm"]')},D=function(){return $('[name="programme[signup]"]')},G={generateGuid:function(){var e=d();return p.PROGRAMME_ID=e},activeStage:function(){return B().index(A())},setActiveStage:function(e){A().removeClass("is-active"),E(e).addClass("is-active")},setCompleteStage:function(e){E(e).addClass("is-complete")},showBanner:function(){M().removeClass("is-inactive")},scroll:function(){$([document.documentElement,document.body]).animate({scrollTop:v().offset().top-h().outerHeight()-2*M().outerHeight()},p.TIME_ANIMATION)},loading:function(e){document.dispatchEvent(new CustomEvent("theme:loading:"+e))},reveal:function(e){var t=this,n=[],r=new TimelineLite({delay:.5});e.forEach((function(e){(e.isIntersecting||e.intersectionRatio>0)&&(n.push(e.target),t.intersectionObserver.unobserve(e.target))})),0!==n.length&&r.staggerFromTo(n,.45,{autoAlpha:0,y:25},{autoAlpha:1,y:0},.2)},bringImagesIn:function(e){setTimeout((function(){var t=$(".FeatureText--withImage img");lazySizes.loader.unveil(t[0]),e.intersectionObserver&&e.intersectionObserver.disconnect(),e.intersectionObserver=new IntersectionObserver(G.reveal.bind(e),{threshold:.3}),$(".ProductList .ProductItem").each((function(t,n){e.intersectionObserver.observe(n)}))}),p.TIME_ANIMATION)},getName:function(){return _().val()},getDOB:function(){return b().val()},getEmail:function(){return x().val()},getFood:function(){return+C().val()},getMilestone:function(){return+w().val()},getCharge:function(){return+T().val()},getChargeUnit:function(){return k().val()},checkDOB:function(){var a=new Date(G.getDOB());return function(a,o){e(2,arguments);var i=t(a),c=t(o),s=n(i,c),u=Math.abs(r(i,c));i.setMonth(i.getMonth()-s*u);var l=n(i,c)===-s,d=s*(u-l);return 0===d?0:d}(new Date,a)},checkCycle:function(){var e=G.scoreTotal();return e>=0&&e<=5?"first-tastes":e>=6&&e<=7?"box-1a":e>=8&&e<=9?"box-2a":e>=10&&e<=15?"box-3a":e>=16?"box-4a":void console.error("The points scored (".concat(e,") don't map to a cycle."))},scoreDOB:function(){var e=G.checkDOB();return e>=0&&e<4?1:e>=4&&e<6?2:e>=6&&e<9?3:e>=9&&e<12?4:e>=12?5:void console.error("There is an issue with the baby's age, ".concat(e))},scoreTotal:function(){return G.scoreDOB()+G.getFood()+G.getMilestone()},getActiveStageDetails:function(){var e,t,n=!0,r=p.activeStage;switch(r){case"info":n=!1;break;case"products":e=G.checkCycle(),t=2;break;case"upsell":e=r,t=3;break;default:throw new Error("Incorrect stage specified, please contact support.")}return{urlSegment:e,stageNumber:t,advance:n}},listID:function(){switch(G.checkCycle()){case"box-1a":return"SuvRL4";case"box-2a":return"XCuZhF";case"box-3a":return"RVhzr2";case"box-4a":return"V6Z4H2";default:return"VdSzen"}},addUserToList:function(e){try{return fetch("https://app.mamamadefood.com/.netlify/functions/server/add/list/"+e,{body:JSON.stringify({email:G.getEmail(),birthday:G.getDOB(),name:G.getName(),food:G.getFood(),milestone:G.getMilestone()}),credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}).then((function(e){return G.loading("end"),e.json().email}))}catch(e){console.error("There has been an error adding you to the mailing list.")}},go:{confirm:function(){G.cart.processAddToCart()},stage:function(e){if(G.loading("start"),p.activeStage=e,"products"===e&&D().is(":checked")){var t=G.listID();console.log("ðŸš€ ~ file: programme-scheme.js ~ line 223 ~ listID",t),G.addUserToList("MTWRkG"),G.addUserToList(t)}var n=G.getActiveStageDetails(),r=n.urlSegment,a=n.stageNumber;if(n.advance){var o=q(a),i=window.theme.collections+r;fetch(i,{credentials:"same-origin",method:"GET"}).then((function(e){e.text().then((function(t){G.loading("end"),e.ok&&(P().hide(),o.html(t).show(),G.showBanner(),G.setCompleteStage(a-1),G.setActiveStage(a),G.scroll(),G.bringImagesIn(o))}))}))}else{var c=q(1);P().hide(),B().eq(1).removeClass("is-complete"),c.show(),G.setActiveStage(1),G.scroll(),G.loading("end")}}},mapStage:function(e){switch(e){case 0:return"info";case 1:return"products";case 2:return"upsell";default:return 0}},cart:{processAddToCart:function(){var e=G.cart.generateCart();e.length>0?G.cart.processToCart(e):console.log("No items available to add to cart.")},generateCart:function(){var e=[],t=G.generateGuid(),n=$("#rc_subscription_id").val(),r=$("#rc_shipping_interval_frequency").val(),a=$("#rc_shipping_interval_unit_type").val(),o=G.getCharge(),i=o>0,c=I().index(T()),s=i?o:r,u=i?G.getChargeUnit():a;return O().each((function(){var o=$(this),l=o.val();i&&(l=o.data("chargebundle-".concat(c))[0]);var d={id:l,quantity:1,properties:{programme_id:t,subscription_id:n,shipping_interval_unit_type:a,shipping_interval_frequency:r,charge_interval_frequency:s,charge_interval_unit_type:u}};e.push(d)})),j().each((function(){var t=$(this).val(),n={id:t,quantity:$('[name="upsell['.concat(t,'][qty]"]')).val()};e.push(n)})),e},processToCart:function(e){var t=R();t.attr("disabled","disabled"),G.loading("start"),fetch(window.theme.localeRootUrl+"/cart/add.js",{body:JSON.stringify({attributes:{programme_id:p.PROGRAMME_ID,programme_name:G.getName(),programme_email:G.getEmail(),programme_dob:G.getDOB(),programme_food:G.getFood(),programme_milestone:G.getMilestone(),programme_stage:G.checkCycle(),programme_has_edited:"false",prgoramme_has_jumped_stage:"false",programme_stage_jumped:""},items:e}),credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}).then((function(n){G.loading("end"),n.ok?($(f).removeClass("hidden"),document.dispatchEvent(new CustomEvent("product:added",{bubbles:!0,detail:{variant:e[0].id,quantity:e[0].quantity}}))):n.json().then((function(e){t.removeAttr("disabled"),t.after('<span class="ProductForm__Error Alert Alert--error">'.concat(e.description,"</span>")),setTimeout((function(){t.siblings(".ProductForm__Error").remove()}),2500)}))}))}},validate:function(){var e=!0;S().each((function(){if(""==$(this).val())return e=!1,!1})),y().prop("disabled",!e)},updateUpsellQuantity:function(e,t){var n=e.find('[name="programme[upsells]"]').val(),r=e.find('[name="upsell['.concat(n,'][qty]"]')),a=e.find(".ProductItem__Quantity"),o=+r.val()+t;o>=0&&(r.val(o),a.text(o))}};function N(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function Q(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){N(o,r,a,i,c,"next",e)}function c(e){N(o,r,a,i,c,"throw",e)}i(void 0)}))}}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var U,H="#box-add-to-cart",W="is-inactive",X='[data-action="toggle-mm-tag"]',V='#collection-filter-drawer [data-action="close-drawer"]',z=function(){return $(".Box")},J=function(){return $(".Grid--box")},Y=function(){return $(".Grid--box > .Grid__Cell")},Z=function(){return $(".ProductItem__Quantity")},K=function(){return $(".ProductItem__Plus")},ee=function(){return $(H)},te=function(){return $("[data-box-radio-size]")},ne=function(){return $("[data-box-radio-frequency]")},re=function(){return $("[data-box-max-text]")},ae=function(){return $(".StagesBanner")},oe=function(){return $(V)},ie={loading:function(e){document.dispatchEvent(new CustomEvent("theme:loading:".concat(e)))},generateGuid:function(){return d()},calculateBoxQuantity:function(e){var t=0;return e.find(".BoxItem").each((function(){t+=+$(this).data("box-qty")})),t},boxMin:function(){return+J().data("box-min")},boxMax:function(){return+J().data("box-max")},updateBoxQuantity:function(e,t){var n=J(),r=ie.boxMin(),a=ie.boxMax(),o=ie.calculateBoxQuantity(n)+t,i=+e.data("box-qty")+t;o>0?ae().is(".".concat(W))&&ae().removeClass(W):ae().addClass(W),ce.isItemGreaterThanZero(i)&&ce.isBoxGreaterThanMin(o,r)&&ce.isBoxLessThanMax(o,a)&&(ie.updateCounts(e,i,o),ie.updatePrice(),ie.disableAdditions(o,a),ie.checkAddToCart(o,a),ie.checkToggles(o))},checkAddToCart:function(e,t){var n=!ce.isBoxEqualMax(e,t);ee().prop("disabled",n),$("#update-order").prop("disabled",n),n?($("[data-box-stage-02], [data-box-stages-complete]").addClass("is-active").removeClass("is-complete"),$("[data-box-stage-01], [data-box-stage-04]").removeClass("is-active")):($("[data-box-stage-01], [data-box-stage-02], [data-box-stages-complete]").removeClass("is-active").addClass("is-complete"),$("[data-box-stage-04]").addClass("is-active"))},checkToggles:function(e){var t=J(),n=ie.boxMin(),r=ie.boxMax();t.find(".BoxItem").each((function(){var t=$(this),a=t.data("box-qty"),o=e||a,i=!!ce.isBoxEqualParam(o,r),c=!(!ce.isBoxEqualParam(o,n)&&!ce.isBoxEqualParam(a,0));t.find(".ProductItem__Plus").prop("disabled",i),t.find(".ProductItem__Minus").prop("disabled",c)}))},updateCounts:function(e,t,n){e.data("box-qty",t),e.find(".ProductItem__Quantity").html(t),$("[data-box-total]").html(n)},updatePrice:function(){var e=J(),t=ie.boxMax(),n=0;e.find(".BoxItem").each((function(){var e=$(this),r=+e.data("box-qty");if(r>0){var a=JSON.parse(e.attr("data-box-variant-".concat(t))),o=(a[0],a[1]);n+=r*(+o/100)}}));e=J();var r=ie.calculateBoxQuantity(e),a=(isNaN(n/r)?0:n/r).toLocaleString("en-GB",{style:"currency",currency:"GBP"});$("[data-box-price-per]").html(a)},reduceQuantities:function(){var e=Z(),t=$(".Grid--box"),n=+t.data("box-max");e.each((function(){var e=$(this),r=+e.text(),a=ie.calculateBoxQuantity(t);if(!(0===r||a<=n)){var o=e.closest(".BoxItem");if(a-r>n)ie.updateCounts(o,0,a);else if(a-r<=n){var i=r-(a-n);ie.updateCounts(o,i,n)}}}))},checkRadios:function(){if(!$("[data-box-stage-01]").is(".is-complete")){var e=te().find(":checked"),t=ne().find(":checked");e.length>0&&t.length>0&&($("[data-box-stage-01]").removeClass("is-active").addClass("is-complete"),$("[data-box-stage-02]").addClass("is-active"))}},checkRadioSize:function(){var e=+te().find(":checked").val();ie.setMax(e);var t=$(".Grid--box"),n=ie.calculateBoxQuantity(t);ie.checkAddToCart(n,e),ce.isBoxOverMax(n,e)&&ie.reduceQuantities()},setMax:function(e){J().data("box-max",+e),re().text(e)},disableAdditions:function(e,t){e==t?K().attr("disabled","disabled"):e<t&&K().removeAttr("disabled")},cart:{processAddToCart:function(){var e=J(),t=ie.calculateBoxQuantity(e),n=+e.data("box-max");if(ce.isBoxEqualMax(t,n)){var r=ie.cart.generateCart(e,"product");r.length>0?ie.cart.processToCart(r):console.log("No items available to add to cart.")}else console.log("Cannot process Add to Cart. Qty does not equal max total.")},generateCart:function(e,t){var n=[],r=ie.boxMax(),a=ie.generateGuid();console.log(a);var o=$("#rc_subscription_id").val(),i=$("#rc_shipping_interval_unit_type").val(),c=$('[name="BoxFrequency"]:checked').val();return e.find(".BoxItem").each((function(){var e=$(this),t=+e.data("box-qty");if(t>0){var s=JSON.parse(e.attr("data-box-variant-"+r)),u=s[0],l=(s[1],{id:u,quantity:t,properties:{box_id:a,box_max:r}});l.properties.subscription_id=o,l.properties.shipping_interval_unit_type=i,l.properties.shipping_interval_frequency=c,n.push(l)}})),n},processToCart:function(e){var t=ee();t.attr("disabled","disabled"),ie.loading("start"),fetch(window.theme.localeRootUrl+"/cart/add.js",{body:JSON.stringify({items:e}),credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}).then((function(n){ie.loading("end"),n.ok?document.dispatchEvent(new CustomEvent("product:added",{bubbles:!0,detail:{variant:e[0].id,quantity:e[0].quantity}})):n.json().then((function(e){t.removeAttr("disabled"),t.after('<span class="ProductForm__Error Alert Alert--error">'+e.description+"</span>"),setTimeout((function(){t.siblings(".ProductForm__Error").remove()}),2500)}))}))}},addToCart:(U=Q(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $("[data-box-stage-04]").addClass("is-active"),e.next=3,fetch("/cart.js",{method:"GET"}).then((function(e){return e.json()})).catch((function(e){return console.error("Error:",e),e.json()}));case 3:return t=e.sent,ie.cart.processAddToCart(),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),function(){return U.apply(this,arguments)}),loadExtras:function(){ie.loading("start");var e="".concat(window.theme.collections,"upsell");fetch(e,{credentials:"same-origin",method:"GET"}).then((function(e){e.text().then((function(t){ie.loading("end"),e.ok&&($("#shopify-section-collection-template").hide(),$("#BoxUpsell").html(t).show())}))}))},toggleDrawer:function(){oe().trigger("click")}},ce={isItemGreaterThanZero:function(e){return!(e<0)||(console.log("Item quantity cannot be less than 0."),!1)},isBoxGreaterThanMin:function(e,t){return!(e<t)||(console.log("Quantity cannot be less than the minimum."),!1)},isBoxLessThanMax:function(e,t){return!(+e>+t)||(console.log("Quantity cannot be greater than maximum."),!1)},isBoxEqualMax:function(e,t){return e==t},isBoxEqualParam:function(e,t){return e==t},isBoxOverMax:function(e,t){return e>t}};function se(){z().length>0&&($("body").on("click",".ProductItem__Minus",(function(){var e=$(this).closest(".BoxItem");ie.updateBoxQuantity(e,-1)})),$("body").on("click",".ProductItem__Plus",(function(){var e=$(this).closest(".BoxItem");ie.updateBoxQuantity(e,1)})),$("body").on("click",H,(function(e){e.preventDefault(),ie.addToCart()})),$("body").on("change",".Radio",(function(){ie.checkRadios(),ie.checkRadioSize(),ie.checkToggles(),ie.updatePrice()})),$("body").on("click",X,(function(e){var t=$(this);if(t.is(".collection-filters_link--active"))return!1;var n=t.data("tag");if(void 0===n)return!1;$(".collection-filters_link--active").removeClass("collection-filters_link--active"),t.addClass("collection-filters_link--active"),Y().show(),"all"!==n&&Y().filter(":not(.is-tag--".concat(n,")")).hide()})),ie.checkToggles())}window.initBox=se;var ue,le,de={cartItemPage:".CartItemWrapper",cartItemCart:".CartItem",cartOpen:'[data-action="open-drawer"]',removeGroup:'[data-action="remove-group"]',money:"[data-money-convertible]"},pe=function(){return $("#CartItemTemplate")},me=function(){return $("#CartItemTemplateGroup")},fe=function(){return $(".Cart__ItemList")},ge=function(){return $(".Cart__Totals, .Cart__Total")},he=function(){return $("#box-add-to-cart")},ve=function(){return $(".Header__CartDot")},ye=function(){return $("#CartTerms")},be=function(){return $('[name="checkout"]')},_e={whichPage:function(){return"cart"!==window.theme.template},clearHTML:function(){fe().find(_e.whichPage()?de.cartItemPage:de.cartItemCart).remove()},createItems:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=F(n[t],2),a=r[0],o=r[1],i=me().html();i=(i=(i=(i=(i=(i=(i=i.replaceAll("${title}",o.title)).replaceAll("${qty}",o.total)).replaceAll("${price}",formatMoney(o.final_line_price,window.theme.moneyFormat))).replaceAll("${uuid}",a)).replaceAll("${keys}",o.items.join(","))).replaceAll("${inputs}",o.inputs.join(""))).replaceAll("${properties}",o.properties.join(""));var c=_e.wrap(i);_e.addItem(c)}},loading:function(e){document.dispatchEvent(new CustomEvent("theme:loading:".concat(e)))},addItem:function(e){fe().append(e)},updateTotals:function(e){var t=formatMoney(e,window.theme.moneyFormat);ge().find(de.money).text(t)},wrap:function(e){return _e.whichPage()?'<div class="CartItemWrapper">'.concat(e,"</div>"):e},empty:(le=Q(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _e.loading("start"),n={},t.forEach((function(e){n[e]=0})),e.next=5,fetch(window.theme.localeRootUrl+"/cart/update.js",{body:JSON.stringify({updates:n}),credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});case 5:return r=e.sent,_e.loading("end"),e.next=9,r.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)}))),function(e){return le.apply(this,arguments)}),cart:(ue=Q(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/cart.js",{method:"GET"});case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.next=8,n;case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)}))),function(){return ue.apply(this,arguments)})},xe=function(){var e=Q(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,c,s,u,l,d,p,m,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.cart();case 2:for(t=e.sent,n=t.items,r=pe(),a=[],o={boxes:{},programmes:{}},_e.updateTotals(t.total_price),i=0,c=Object.entries(n);i<c.length;i++)s=F(c[i],2),s[0],(u=s[1]).properties&&("box_id"in u.properties||"programme_id"in u.properties)?(l="box_id"in u.properties?"boxes":"programmes",d="box_id"in u.properties?"box_id":"programme_id",p="box_id"in u.properties?"Build a box bundle":"Programme scheme bundle",u.properties[d]in o[l]||(o[l][u.properties[d]]={},o[l][u.properties[d]].title=p,o[l][u.properties[d]].items=[],o[l][u.properties[d]].inputs=[],o[l][u.properties[d]].properties=[],o[l][u.properties[d]].properties.push('<li class="CartItem__Property">Ships every '.concat(1==+u.properties.shipping_interval_frequency?"":u.properties.shipping_interval_frequency," ").concat(u.properties.shipping_interval_unit_type.toLowerCase()).concat("s"===u.properties.shipping_interval_unit_type.charAt(u.properties.shipping_interval_unit_type.length-1)?"":"s","</li>")),"charge_interval_frequency"in u.properties&&o[l][u.properties[d]].properties.push('<li class="CartItem__Property">Charge every '.concat(u.properties.charge_interval_frequency," ").concat(u.properties.charge_interval_unit_type.toLowerCase()).concat("s"===u.properties.charge_interval_unit_type.charAt(u.properties.charge_interval_unit_type.length-1)?"":"s","</li>"))),o[l][u.properties[d]].items.push(u.key),o[l][u.properties[d]].inputs.push('<input type="hidden" disabled name="updates[]" id="updates_'.concat(u.key,'" class="QuantitySelector__CurrentQuantity" pattern="[0-9]*" data-line-id="').concat(u.key,'" value="1">')),o[l][u.properties[d]].total="total"in o[l][u.properties[d]]?o[l][u.properties[d]].total+u.quantity:u.quantity,o[l][u.properties[d]].final_line_price="final_line_price"in o[l][u.properties[d]]?o[l][u.properties[d]].final_line_price+u.final_line_price:u.final_line_price):(m=(m=(m=(m=(m=(m=(m=(m=(m=(m=(m=(m=r.html()).replaceAll("${image}",u.featured_image.url)).replaceAll("${ratio}",u.featured_image.aspect_ratio)).replaceAll("${title}",u.product_title)).replaceAll("${variant}",u.variant_title?u.variant_title:"")).replaceAll("${price}",formatMoney(u.final_line_price,window.theme.moneyFormat))).replaceAll("${qty}",u.quantity)).replaceAll("${quantity_minus_one}",u.quantity-1)).replaceAll("${quantity_plus_one}",u.quantity+1)).replaceAll("{{new_quantity}} ","")).replaceAll("${key}",u.key)).replaceAll("${url}",u.url),f=_e.wrap(m),a.push(f));_e.clearHTML(),jQuery.isEmptyObject(o.boxes)||_e.createItems(o.boxes),jQuery.isEmptyObject(o.programmes)||_e.createItems(o.programmes),_e.addItem(a.join(""));case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function $e(){var e;xe(),e=$("body"),ye().on("click",(function(){var e=$(this).get(0).checked;be().attr("disabled",!e)})),e.on("click",de.cartOpen,(function(){xe()})),e.off("click",de.removeGroup),e.on("click",de.removeGroup,function(){var e=Q(regeneratorRuntime.mark((function e(t){var n,r,a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=$(t.target),r=n.closest(_e.whichPage()?de.cartItemPage:de.cartItem),a=n.data("line-ids"),o=a.split(","),e.next=7,_e.empty(o);case 7:return e.sent,e.next=10,_e.cart();case 10:i=e.sent,c=new TimelineLite({onComplete:function(){r.remove()}}),_e.updateTotals(i.total_price),c.to(r,.5,{height:0,opacity:0,ease:Cubic.easeOut},0),he().prop("disabled",!1),0===i.item_count?(ve().removeClass("is-visible"),_e.whichPage()?c.to($(".Cart .Drawer__Footer"),.5,{y:"100%",transition:"none",ease:Cubic.easeInOut},0):new TimelineLite({onComplete:function(){$("#cart-page .Container").replaceWith('\n              <div class="EmptyState">\n                <div class="Container">\n                  <h1 class="EmptyState__Title Heading Heading__h4">Your cart is empty</h1><a href="/pages/join-program" class="EmptyState__Action Button Button--primary">Shop our products</a>\n                </div>\n              </div>\n            ')}}).to($(".Cart"),.5,{y:"100%",transition:"none",ease:Cubic.easeInOut},0)):(ve().addClass("is-visible"),c.to($(".Cart .Drawer__Footer"),.5,{y:"0",transition:"none",ease:Cubic.easeInOut},0));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),"cart"===window.theme.template&&be().attr("disabled",!0)}window.buildCart=$e;var Ce=function(){return $(".ProductItem__ImageWrapper")};v().length>0&&($("body").on("click",".GroupCta .Button",(function(e){e.preventDefault();var t=$(this).data("stage");"confirm"===t?G.go.confirm():G.go.stage(t)})),$("body").on("click",".ProductItem__Minus",(function(){var e=$(this).closest(".ProductItem");G.updateUpsellQuantity(e,-1)})),$("body").on("click",".ProductItem__Plus",(function(){var e=$(this).closest(".ProductItem");G.updateUpsellQuantity(e,1)})),$("body").on("click",g,(function(e){e.preventDefault(),G.loading("start"),$(".ProductList > .hidden-phone").removeClass("hidden-phone"),$(g).attr("disabled","disabled").hide(),G.loading("end")})),B().on("click",(function(e,t){e.preventDefault();var n=$(this);if(!n.hasClass("is-active")&&n.hasClass("is-complete")){var r=B().index(n),a=G.mapStage(r);G.go.stage(a)}})),S().on("blur",G.validate),flatpickr("#ProgrammeDate",{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d",maxDate:new Date,onChange:G.validate}),G.validate()),se(),$e(),"collection"===window.theme.template&&($("body"),Ce().on("click",(function(e){e.preventDefault()})),MicroModal.init()),function(){var e=document.querySelectorAll("[data-js-rc]");function t(){return(t=Q(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null!==(t=document.querySelector("[data-customer-id]"))){e.next=4;break}return e.abrupt("return",!1);case 4:return n=t.dataset.customerId,e.next=7,fetch("/tools/recurring/get_rc_token/".concat(n)).then((function(e){return e.clone().text()})).then((function(e){return JSON.parse(e.match(/{"rc_customer":.*}}/g)[0])})).catch((function(e){console.log(e)}));case 7:return r=e.sent,e.abrupt("return",r.rc_customer);case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}e.length>0&&function(){return t.apply(this,arguments)}().then((function(t){e.forEach((function(e){var n=e.dataset.jsRc,r="/tools/recurring/portal/".concat(t.hash,"/").concat(n),a="token=".concat(t.token);n.includes("?")?e.href=r+"&"+a:e.href=r+"?"+a}))}))}()}();
